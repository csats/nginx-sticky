language: ruby # Default. We don't really need ruby.
services:
  - docker
env:
  global:
    - secure: "gM8XW6pbzUCnRDyY6b4zBSV+cMMGfwY0Vb093GCE4KcyGY1vMz52drujPTOBwJQaWuM9RiI4Gl2CsM+BYtX276z3AwzQU76BMENd8wtvHnqt1xFPJzNatsHRtV/rpXPb6HdaPs2d3vNS5y4AzuR69d1Oz3h7CHEsSNTJaGHfxXXTUIt+GqnpBoT3/uIBUZkt06B/AK5G08+5lcvIsU4499KaLNyHewuF7rbGFD5nMoSjVptGuxW7lkXvL2J+0AxpBnr5pODfke12j6raRLGN2NDZj6O7J6+rsXYzRKYc91qTMjiH4IXWvJ2ogb52x7z0zlSVxsKwL5Ap/KhalEKy3b937tNfQGYBdAS5qPm/nHOclLe8stUNNuh75UeFxnnme096cSr8TNgy9clLQRr6Es07IO25RX0OWamKicvpHtgaFtBJmVXVmQ0bdUpplcc9JX+isWOj7mKiAqAkoLLhUXd/Ko6u3wpARtUbJZfKCa0z14yyeiCpeqy9HtEmEWs5YPgLsVQJXD4riVCUGC39/5MYL6WJE2XX+enucdMX1eRNIm247hSRT8NKVDl8Vid/d/krBDcvfdU00a2WDoxsaWjvZHYXkIMv94RKxvNe9kcxd+QqtqJiZGMJtpCluNO7ffrePQPIwXgX+6Rg+4aK/2424feb94mr7cLvuod7iYI="
    - secure: "HV+EwW/cBYVj/pN7VBVMFvBciSZG6xslGGlHfJgMJHn4MH7TYEK1hV4q18xpBs5aOfDUg5+7TzwXv5qsfqJXJDn3fFVuF+MHEIubKRhBKUEUCoWXqkATpR00xRvTpQG4IAPkJ2MevZHeXd23I4kFiMfCg9CorI2QoMJ4FjO2r6aucoOrKI6KO60ed6ckPFU4SwwvXSK/URSLP0IX0cnq/olYZTWOh2KpdiYvQnucqYui0l/JtOTikfgi1Z80yNnvx3uCW5JdlZSgoltjrStroqKIuvSMDqo0buUKxSRN0jCXPzyaKLsNG5l8QM4qYRxL+5ElsbKl9727hPdhwIE9Uz34jTz1tKef6B1+3FnCZw8Ft/Iv1/eWuRDa3X5LBuscIeIkWfSNhYJr7lvdtdrHSVnvX57UVkU8ZGc4bdfqLrHb+z6/OBFUoj21qMaPJHdAXT1/HCZPhE0q3OfdDsui/PNdS6LHt08nZ3aHU8JzL0/QohYDKYasRARhU9toxmvDpBFq2HBSC2GmKzJa7Ood/lq4eASl32u1YVwOAmrd3h7yG8CPKIqN7okopkVSccYUyiJwgc6In+7eFD7MsKpMjuC3WedxzLVWbym3bYmjGdLPIfPpeojpxMbCigACv8pKCbtfKPIODwldaScNYu+OF8gWJYNLhGXU/2mVURbZtg4="
    - secure: "mBCim0S/4iifHCj48o4BK3B1JYH8TJpA5YgzHHPuTn96kJABTEQk+7XPbhQ7EcWlpsDcc+4FKr+MwSz1b8vgsbNKf70wR4R60f1yICCKr4iaVLj/L7DtW835osimuCUVFrBn8xeuv9uGhnBVnsz2zDdt6yMfLRix1xgrrg4/VKb4GIcJ8eq8rfCxGrnCanlX07U4GHeZjuzU7uf/rNPTiFl0vuZxQ5kNYuOYD6RzfmKjCqn/UVC2kNcGP9942p0GdeKgkbqpmaVXo8ktzJA/kWlwl3laOuiAWRvrtXLkWyEcPz5HsN0kePKwg/27dVxBk9RP8ySJODHEfBnpxl0GMi/JSES1wS3kgI2y6lMm43AXVVSQO/6sRtole1FzeZMCsCnyKMyjEZIFpSwX4kTmxaDcZIZmO9mrJDutV+w+Uiy9HIziL67FqPvC2rfo3Eh2TwbaeZ8Hb5AeFyGDbP1OZH5+sS6rp8VlbGpxm1XukFLOdD+FGS6aOp4VtEBH4i8njDgk+R7eauDzl0yT2zrpiACldNDcpknEkBmzTwTeCWAXy2OqP1LiD1L6ueC3SnIqyEGEshJPI4c2AdaVMipCE/97jB/04kaoG6YynNvg3Exhd7lVTx8UNpxZ1ZLJRqt441WyJrEnt7DMUXIankrIpaIcnNXXvYhYGP44Mh7LdE0="

script:
  - docker run -it -v $TRAVIS_BUILD_DIR:/host debian:jessie /host/build-nginx.sh
  - docker build -t docker.io/csats/nginx-sticky .

after_success:
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - docker push docker.io/csats/nginx-sticky:latest
