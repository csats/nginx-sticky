language: ruby # Default. We don't really need ruby.
services:
  - docker
env:
  global:
  - secure: yBvGmXsdm3zxhWjQ2BJsEcnZ7zs4Q5KA7cpun7gt1lLNuFDGFLf5TinG+NdAJqqWnr9v5JadK7exaDYNNPDrp85p70hRP0FHkFFt/YwGoHJwLFtA2GiE+R3Lu2zXlfhsUOGStclLsXXlFlRFbpzBSfIV6Kg4RjNNGSToyb9ST0ecbiRO8bmT1wNjyeGc3fW2i6ZejLiv71/eYVTVAqGWNv1PE4xkq70pCoJgJHWDolwdDdrk1kl7WNSzbB6Ax/WFSa6cpoehX8j0/w3dJcnMCHoCr31cJ/3GpKhc7ETxW9SENzQbUp7Y/7eXO7fyqVySOXpIq2K47uK6aaxVZCcqqYVr9YSZJoxPVsAmig10bU+NQbCIgw/pyprcDGjwaZzAr8GDtBEoXzO2nLfaKGPsv6GXnWi2rBoK/AuSVC1rbxhCK8XfQoaMdyrzWYiipq4AuftX8N65p9ukIDtTHwBHbINR3FZFSBO4/1uzFYojNoaVoDjBG3ISOk7+x36fznlEQqJbAIpuOyOkF/YOHAfJxmufpE0Opi/bMnXEAKulg4ZpfYLU9qUidqgFXnKnb9ORJQ4jOK2lg376FhoDqQVe++TSTKZdoV4EjStnV5fiiidBY4/Vau8wf3JEuqVt+yt9zLsNvjzg4aWAaSaI28hJuYf1lehi+yXyl/NgxAC8fDg=
  - secure: fHZseYRIL9KD5UinzMmd1gyYa3G/l6j63iCq+gD1PADA4tPyOeRd+gbjvxxhCEiqezq49PGIZx6gpfJkMdPz5OEArMlUfQacVCmgoKqQxQFPVa06g7fWEeNAw5v/7QuVxc7hc0zC2a3JMHayWaZJpdnteKOgakzEA37l6LBZD7OKfCPsqEhaswS0ByFLizrQlCRPmeI9IG8KByDsrPITNBRfFaSLJBkOMvs7dThbmBZbiRAJV1yxd4fC+Em9i1beKYGh16v2fIhBoBoREwUbyJcQ2bfFaaSbT16d3KB/sVTmyx/P7PhUAlqruqGCcLxSe05Gryf838t8Kv0uQhPIje3I9TQhQxTStZN6RO6WwJt1p4oUy7RmJklKoqwOkcchOIJD9ErbcL6AVZoYH7wLB8fB4dz7jvCIj/+MweiR5yyYXyD1y6jJDNQ4VR/CH4jqBgW55++yBQ9m4q42XuV6vYgWwMTb7sqbaqIYnmuPDsKjqiA3+P+tMNKTQbjeQHHIqc4m/d7kC3SpWB4hDXsLKlegQo4cXJcjiIBcUyHljxZvr7Xl6zs5KNWCsKS+eD6ol8Tsw37ZC1fbhw7fb/J6lqorxfFS7GqElHOJsmzMnM/tbBkt3Lqo/G4ZrgIscp/MlCR3pTyFbODyEsWXnVi0DcHZxceUSTGzBXa6LcCHiIg=
  - secure: eIbMTWnaLbi9mbInkSyClggJXczVNpCj4PXg42Ihq/IHBgJYXPeKUzEPCRpClkIsp6ANq3PlOpH0mK6wkDuuPC/lA/6hGv0anRDyEbjwgHyNRPCYXHVZ0keVDi8E8R9E8WPsMwrN1IJnqMI5kCcP8KNXYkMScQUgjh0e3J0dzAfHmvtvEmOxlFTvteF4UeMogyhaz+wrd7EX1ukSYKOe26w3jogRp4xHoaQo9q3avMmvDqhJrgix06TYKsOHNFijWVJAhoO4cMnHS5IvyR9qr9FFmwk4NCkhgtcPnpOYlrkEIAqX7yPUneoaAyvyWPZ1ocwIEfwCQ+iv+XxStx0T0o1aeiU106ti/znJNY1GGDnKodooK+JQSGIKppXdJV02Wh32k0ShhtvccQlxOxa7XkM9kvXRx6MEOc6Dq/2PPf8nAeUJUslAdmdrDbLYH8QPkS1H6O1mJ1cwDZyd2C6arpY0wyAC/9N4LNbeaHhW0KnkfTA1vpSmonvxUTUWhOLXxAP1DI24KjPnPCQj6SzANWnufRE5ERXoI/SCq4HYbpfMMez2vco0PEdoOqWCOvsGkj54AgfXsm5eh8dvRYJXIjeTBbhBgcFi0hJZBMehLehiVHUFIkAViu1n0AHlwYPqggJNGQ7VsdFckG84MJQVzOpSpw6e4zjskQY9YVGiUjc=
script:
  - docker run -it -v $TRAVIS_BUILD_DIR:/host debian:jessie /host/build-nginx.sh
  - docker build -t docker.io/csats/nginx-sticky .

after_success:
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - docker push docker.io/csats/nginx-sticky:latest
